# 示例环境变量文件，用于后端配置。复制为 `.env` 后生效。

# API_FETCH_JOBS：以 JSON 字符串定义 APScheduler 的数据拉取任务列表
# 规则说明：
# - 支持两种触发方式：
#   1) interval（固定分钟间隔）
#   2) cron（标准 5 段 Linux Cron 表达式：min hour dom mon dow）
# - 当 period_type 为 "month"，且未显式提供 p_date_m 或 date_m 时，系统自动生成：
#   - p_date_m：YYYY-MM
#   - date_m：YYYY-MM-DD（该月最后一天）
#   - period：YYYYMM
#   自动生成依据：若提供了 period 则按它解析，否则按 month_offset 相对当前月份计算（默认 -1 表示上月）。
# - 稳定表名计算会忽略 date_m/p_date_m，避免每期落不同表；去重逻辑按 period 做库级去重。

# 间隔触发示例（每 10 分钟执行一次）：
API_FETCH_JOBS=[{"id":"fetch_api_interval_10m","interval_minutes":10,"endpoint":"https://example.com/report","method":"GET","period_type":"month","month_offset":-1,"date_m":null,"p_date_m":null,"headerKey":"Authorization","headerValue":"Bearer xxx","paramKey":"tenant","paramValue":"acme","cookieKey":null,"cookieValue":null,"timeout":60,"separator":"_"}]

# Cron 触发示例（每月 1 日 02:00 执行）：
# API_FETCH_JOBS=[{"id":"fetch_api_monthly","cron":"0 2 1 * *","endpoint":"https://example.com/report","method":"GET","period_type":"month","month_offset":-1,"date_m":null,"p_date_m":null,"headerKey":"Authorization","headerValue":"Bearer xxx","paramKey":"tenant","paramValue":"acme","cookieKey":null,"cookieValue":null,"timeout":60,"separator":"_"}]

# BI Excel 批量入库示例（每月 2 日 03:00 执行）：
# API_FETCH_JOBS=[{"id":"bi_excel_monthly","cron":"0 3 2 * *","type":"bi_excel","endpoint":"http://127.0.0.1:8030/download_excel","file_ids":[1,2,3],"period_type":"month","month_offset":-1,"p_unit":1}]

# BI Excel 日报示例（每天 03:00 跑前一天的数据）：
# API_FETCH_JOBS=[{"id":"bi_excel_daily","cron":"0 3 * * *","type":"bi_excel","endpoint":"http://127.0.0.1:8030/download_excel","file_ids":[1,2,3],"period_type":"day","day_offset":-1,"p_unit":1}]

# 使用方法：
# 1) 复制本文件为项目根目录下的 `.env`
# 2) 修改 `API_FETCH_JOBS` 中的 endpoint/认证/参数等为你的实际配置
# 3) 重启后端，访问 GET /scheduler/jobs 可查看任务的 next_run_time

# Excel 清理设置：
# - KEEP_PROCESSED_EXCEL：是否保留预处理后的 Excel 文件（*_processed.xlsx）。默认 false（入库后立即删除）。
# - EXCEL_RETENTION_DAYS：保留期（天）。每日 03:00 的定时清理任务会删除超过该天数的 *_processed.xlsx。
KEEP_PROCESSED_EXCEL=false
EXCEL_RETENTION_DAYS=30